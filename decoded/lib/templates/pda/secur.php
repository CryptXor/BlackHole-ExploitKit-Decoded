<?php 
if( !defined("ADMIN_LOADED") ) 
{
    exit();
}

define("PAGE", "secur");
$imgPath = Config::get("AdminScriptName") . "?" . Config::get("MainParamName") . "=file&type=img&file=";
$list1 = db::select("select ID, Title from IP where Type = 0 order by ID asc");
$list2 = db::select("select ID, Title from IP where Type = 1 order by ID asc");
echo "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\r\n\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\r\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\r\n<head>\r\n\t<title>";
echo Lang::get("MenuSecurityButton");
echo "</title>\r\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\r\n\t<link rel=\"stylesheet\" href=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=file&type=css&file=main.css\" type=\"text/css\" media=\"screen\" />\r\n</head>\r\n<body>\r\n\t<div class=\"title\">\r\n\t\t<ul>\r\n\t\t\t<li class=\"logo\"><a href=\"";
echo Config::get("AdminScriptName");
echo "\"><img src=\"";
echo $imgPath;
echo "logo.gif\" width=\"15px\" height=\"15px\"/></a></li>\r\n\t\t\t<li><a href=\"";
echo Config::get("AdminScriptName");
echo "\">";
echo Lang::get("MenuMainButton");
echo "</a></li>\r\n\t\t\t<li><a href=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=threads\">";
echo Lang::get("MenuThreadsButton");
echo "</a></li>\r\n\t\t\t<li><a href=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=files\">";
echo Lang::get("MenuFilesButton");
echo "</a></li>\r\n\t\t</ul>\r\n\t\t<div class=\"controls\">\r\n\t\t\t<ul>\r\n\t\t\t\t<li class=\"edit\"><a href=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=prefs\"><img src=\"";
echo $imgPath;
echo "edit.gif\" width=\"7px\" height=\"7px\"/></a></li>\r\n\t\t\t\t<li class=\"logout\"><a href=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=logout\"><img src=\"";
echo $imgPath;
echo "logout.gif\" width=\"6px\" height=\"10px\"/></a></li>\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t\t<div style=\"clear:both;\"></div>\r\n\t</div>\r\n\t\r\n\t<div class=\"files\">\r\n\t\t<div class=\"files_title\">";
echo Lang::get("BlackList");
echo "</div>\r\n\t\t<div class=\"secur_title\">";
echo Lang::get("StatisticsReferersLabel");
echo "</div>\r\n\t\t";
foreach( $list1 as $k => $l ) 
{
    if( 30 < strlen($l["Title"]) ) 
    {
        $title = mb_substr($l["Title"], 0, 20) . "..." . mb_substr($l["Title"], 0 - 10);
    }
    else
    {
        $title = $l["Title"];
    }

    echo "\t\t\t<div class=\"secur_list";
    if( $k % 2 == 0 ) 
    {
        echo " odd";
    }

    echo "\">\r\n\t\t\t\t";
    echo $title;
    echo "\t\t\t\t<div style=\"float:right;\">\r\n\t\t\t\t\t<a href=\"";
    echo Config::get("AdminScriptName");
    echo "?";
    echo Config::get("MainParamName");
    echo "=delIP&id=";
    echo $l["ID"];
    echo "\"><img src=\"";
    echo $imgPath;
    echo "trash.gif\" width=\"9px\" height=\"9px\"/></a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t";
}
echo "\t\t<div class=\"add\">\r\n\t\t\t<form action=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=addUrl\" method=\"post\">\r\n\t\t\t\t<input type=\"text\" class=\"text\" name=\"value\"/>\r\n\t\t\t\t<input type=\"submit\" class=\"submit\" value=\"Add\"/>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t\t<div class=\"secur_title ip\">IP</div>\r\n\t\t";
foreach( $list2 as $k => $l ) 
{
    if( 30 < strlen($l["Title"]) ) 
    {
        $title = mb_substr($l["Title"], 0, 20) . "..." . mb_substr($l["Title"], 0 - 10);
    }
    else
    {
        $title = $l["Title"];
    }

    echo "\t\t\t<div class=\"secur_list";
    if( $k % 2 == 0 ) 
    {
        echo " odd";
    }

    echo "\">\r\n\t\t\t\t";
    echo $title;
    echo "\t\t\t\t<div style=\"float:right;\">\r\n\t\t\t\t\t<a href=\"";
    echo Config::get("AdminScriptName");
    echo "?";
    echo Config::get("MainParamName");
    echo "=delIP&id=";
    echo $l["ID"];
    echo "\"><img src=\"";
    echo $imgPath;
    echo "trash.gif\" width=\"9px\" height=\"9px\"/></a>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t";
}
echo "\t\t<div class=\"add\">\r\n\t\t\t<form action=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=addIP\" method=\"post\">\r\n\t\t\t\t<input type=\"text\" class=\"text\" name=\"value\"/>\r\n\t\t\t\t<input type=\"submit\" class=\"submit\" value=\"Add\"/>\r\n\t\t\t</form>\r\n\t\t</div>\r\n\t</div>\r\n\r\n</body>\r\n</html>";

