<?php 
if( !defined("ADMIN_LOADED") ) 
{
    exit();
}

$fileName = db::selectone("Title", "Files", "ID = " . intval($_POST["fileID"]));
$file = $_SERVER["DOCUMENT_ROOT"] . "/files/" . intval($_POST["fileID"]);
$res = _obfuscated_0D0A220E352B17130D272B0905173E061407040F2C0B01_($file, intval($_POST["fileID"]));
$fileDate = date("d-m-Y H:i:s");
if( $res !== false ) 
{
    list($finded, $total, $data) = $res;
    ksort($data, SORT_STRING);
}

echo "\t\n<div class=\"title\">";
echo Lang::get("Antivirus");
echo "</div>\n<div class=\"fileInfo\">\n\t";
echo Lang::get("FileReceived", $fileName, $fileDate);
echo "\t<br/>\n\t";
if( $res === false ) 
{
    echo "\t\t";
    echo Lang::get("ScanError");
    echo "\t";
}
else
{
    echo "\t\t";
    echo Lang::get("ResultFileScan");
    echo ": <b>";
    echo $finded;
    echo "/";
    echo $total;
    echo " (";
    echo round($finded / $total * 100);
    echo "%)</b>\n\t";
}

echo "</div>\n";
if( $res !== false ) 
{
    echo "\t<table>\n\t\t<thead>\n\t\t\t<td style=\"padding-left:10px;\">";
    echo Lang::get("Antivirus");
    echo "</td>\n\t\t\t<td>";
    echo Lang::get("ResultFileScan");
    echo "</td>\n\t\t</thead>\n\t\t<tbody>\n\t\t\t";
    $k = 0;
    foreach( $data as $av => $err ) 
    {
        $k++;
        echo "\t\t\t<tr";
        if( $k % 2 ) 
        {
            echo " class=\"odd\"";
        }

        echo ">\n\t\t\t\t<td>";
        echo $av;
        echo "</td>\n\t\t\t\t<td>";
        if( $err != "-" ) 
        {
            echo "<span style=\"color:red;\">" . $err . "</span>";
        }
        else
        {
            echo $err;
        }

        echo "</td>\n\t\t\t</tr>\n\t\t\t";
    }
    echo "\t\t</tbody>\n\t</table>\n";
}


