<?php 
if( !defined("ADMIN_LOADED") ) 
{
    exit();
}

$imgPath = Config::get("AdminScriptName") . "?" . Config::get("MainParamName") . "=file&type=img&file=";
$fileID = (isset($_POST["fileID"]) ? intval($_POST["fileID"]) : null);
$defComment = Lang::get("DefComment");
if( $fileID != null ) 
{
    $data = db::selectone("*", "Files", "ID=" . $fileID);
    $limit = ($data["FileLimit"] != 0 - 1 ? $data["FileLimit"] : "&#8734");
    $comment = $data["Comment"];
}
else
{
    $comment = $defComment;
}

echo "\t\r\n<div class=\"main\">\r\n\t<form id=\"fileUploadForm\" onsubmit=\"return Files.submit()\" action=\"";
echo Config::get("AdminScriptName");
echo "?";
echo Config::get("MainParamName");
echo "=fileUploadAjax\" method=\"post\" enctype=\"multipart/form-data\">\r\n\t\t";
if( $fileID != null ) 
{
    echo "\t\t\t<input type=\"hidden\" name=\"fileID\" value=\"";
    echo $fileID;
    echo "\"/>\r\n\t\t\t<input type=\"hidden\" name=\"FileUpload\" value=\"1\"/>\r\n\t\t";
}

echo "\t\t<div class=\"title\">";
echo Lang::get("FileUpload");
echo "</div>\r\n\t\t<div class=\"title title2\">";
echo Lang::get("LoadsLimit");
echo "\t\t\t<div class=\"close\" id=\"addFileClose\"></div>\r\n\t\t</div>\r\n\t\t<div style=\"clear:both;\"></div>\r\n\t\t<div class=\"content\">\r\n\t\t\t<input type=\"file\" name=\"file\" id=\"File\"/>\r\n\t\t\t<input type=\"text\" class=\"text input_mask mask_number\" id=\"Limit\" name=\"Limit\"";
if( $fileID != null ) 
{
    echo " value=\"" . $limit . "\"";
}
else
{
    echo " value=\"&#8734;\"";
}

echo " onclick=\"this.select()\"/>\r\n\t\t\t<div class=\"infin\" onclick=\"\$('Limit').value='&#8734;'\"><img src=\"";
echo $imgPath;
echo "infin.png\" width=\"13px\" height=\"5px\"/></div>\r\n\t\t\t";
if( $fileID != null ) 
{
    echo "\t\t\t\t<br/><br/><input type=\"checkbox\" name=\"FileReplace\" id=\"FileReplace\"/><label for=\"FileReplace\">";
    echo Lang::get("ReplaceFile");
    echo "</label>\r\n\t\t\t\t<div style=\"float:right;width:130px;\"><input type=\"checkbox\" name=\"FileNull\" id=\"FileNull\"/><label for=\"FileNull\">";
    echo Lang::get("FileNull");
    echo "</label></div>\r\n\t\t\t";
}

echo "\t\t</div>\r\n\t\t<div class=\"comment\">\r\n\t\t\t<input type=\"text\" class=\"text\" name=\"FileComment\" value=\"";
echo $comment;
echo "\" onfocus=\"if(this.value=='";
echo $defComment;
echo "'){this.value='';this.style.color='#000';}\" onblur=\"if(this.value==''){this.value='";
echo $defComment;
echo "';this.style.color='#bbb';}\"";
if( $fileID == null ) 
{
    echo " style=\"color:#bbb;\"";
}

echo "/>\r\n\t\t\t<input type=\"submit\" class=\"filesubmit\" value=\"Submit\"/>\r\n\t\t</div>\r\n\t</form>\r\n\t<iframe id=\"upload_target\" name=\"upload_target\" src=\"\" style=\"width:0px;height:0px;border:0;\"></iframe> \r\n</div>";

